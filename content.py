from PyPDF2 import PdfReader, PdfWriter

# https://chatgpt.com/share/a9520757-ba06-4c8a-945b-1d3c381eb6dc
# Define your TOC entries and their corresponding page numbers
toc_entries = [
    ("I Probability", 1),
    ("1 Probability", 3),
    ("1.1 Introduction", 3),
    ("1.2 Sample Spaces and Events", 3),
    ("1.3 Probability", 5),
    ("1.4 Probability on Finite Sample Spaces", 7),
    ("1.5 Independent Events", 8),
    ("1.6 Conditional Probability", 10),
    ("1.7 Bayes’ Theorem", 12),
    ("1.8 Bibliographic Remarks", 13),
    ("1.9 Appendix", 13),
    ("1.10 Exercises", 13),
    ("2 Random Variables", 19),
    ("2.1 Introduction", 19),
    ("2.2 Distribution Functions and Probability Functions", 20),
    ("2.3 Some Important Discrete Random Variables", 25),
    ("2.4 Some Important Continuous Random Variables", 27),
    ("2.5 Bivariate Distributions", 31),
    ("2.6 Marginal Distributions", 33),
    ("2.7 Independent Random Variables", 34),
    ("2.8 Conditional Distributions", 36),
    ("2.9 Multivariate Distributions and iid Samples", 38),
    ("2.10 Two Important Multivariate Distributions", 39),
    ("2.11 Transformations of Random Variables", 41),
    ("2.12 Transformations of Several Random Variables", 42),
    ("2.13 Appendix", 43),
    ("2.14 Exercises", 43),
    ("3 Expectation", 47),
    ("3.1 Expectation of a Random Variable", 47),
    ("3.2 Properties of Expectations", 50),
    ("3.3 Variance and Covariance", 50),
    ("3.4 Expectation and Variance of Important Random Variables", 52),
    ("3.5 Conditional Expectation", 54),
    ("3.6 Moment Generating Functions", 56),
    ("3.7 Appendix", 58),
    ("3.8 Exercises", 58),
    ("4 Inequalities", 63),
    ("4.1 Probability Inequalities", 63),
    ("4.2 Inequalities For Expectations", 66),
    ("4.3 Bibliographic Remarks", 66),
    ("4.4 Appendix", 67),
    ("4.5 Exercises", 68),
    ("5 Convergence of Random Variables", 71),
    ("5.1 Introduction", 71),
    ("5.2 Types of Convergence", 72),
    ("5.3 The Law of Large Numbers", 76),
    ("5.4 The Central Limit Theorem", 77),
    ("5.5 The Delta Method", 79),
    ("5.6 Bibliographic Remarks", 80),
    ("5.7 Appendix", 81),
    ("5.7.1 Almost Sure and L1 Convergence", 81),
    ("5.7.2 Proof of the Central Limit Theorem", 81),
    ("5.8 Exercises", 82),
    ("II. Statistical Inference", 86),
    ("6 Models, Statistical Inference and Learning", 87),
    ("6.1 Introduction", 87),
    ("6.2 Parametric and Nonparametric Models", 87),
    ("6.3 Fundamental Concepts in Inference", 90),
    ("6.3.1 Point Estimation", 90),
    ("6.3.2 Confidence Sets", 92),
    ("6.3.3 Hypothesis Testing", 94),
    ("6.4 Bibliographic Remarks", 95),
    ("6.5 Appendix", 95),
    ("6.6 Exercises", 95),
    ("7 Estimating the cdf and Statistical Functionals", 97),
    ("7.1 The Empirical Distribution Function", 97),
    ("7.2 Statistical Functionals", 99),
    ("7.3 Bibliographic Remarks", 104),
    ("7.4 Exercises", 104),
    ("8 The Bootstrap", 107),
    ("8.1 Simulation", 108),
    ("8.2 Bootstrap Variance Estimation", 108),
    ("8.3 Bootstrap Confidence Intervals", 110),
    ("8.4 Bibliographic Remarks", 115),
    ("8.5 Appendix", 115),
    ("8.5.1 The Jackknife", 115),
    ("8.5.2 Justification For The Percentile Interval", 116),
    ("8.6 Exercises", 116),
    ("9 Parametric Inference", 119),
    ("9.1 Parameter of Interest", 120),
    ("9.2 The Method of Moments", 120),
    ("9.3 Maximum Likelihood", 122),
    ("9.4 Properties of Maximum Likelihood Estimators", 124),
    ("9.5 Consistency of Maximum Likelihood Estimators", 126),
    ("9.6 Equivariance of the mle", 127),
    ("9.7 Asymptotic Normality", 128),
    ("9.8 Optimality", 130),
    ("9.9 The Delta Method", 131),
    ("9.10 Multiparameter Models", 133),
    ("9.11 The Parametric Bootstrap", 134),
    ("9.12 Checking Assumptions", 135),
    ("9.13 Appendix", 135),
    ("9.13.1 Proofs", 135),
    ("9.13.2 Sufficiency", 137),
    ("9.13.3 Exponential Families", 140),
    ("9.13.4 Computing Maximum Likelihood Estimates", 142),
    ("9.14 Exercises", 146),
    ("10 Hypothesis Testing and p-values", 149),
    ("10.1 The Wald Test", 152),
    ("10.2 p-values", 156),
    ("10.3 The χ2 Distribution", 159),
    ("10.4 Pearson’s χ2 Test For Multinomial Data", 160),
    ("10.5 The Permutation Test", 161),
    ("10.6 The Likelihood Ratio Test", 164),
    ("10.7 Multiple Testing", 165),
    ("10.8 Goodness-of-fit Tests", 168),
    ("10.9 Bibliographic Remarks", 169),
    ("10.10 Appendix", 170),
    ("10.10.1 The Neyman-Pearson Lemma", 170),
    ("10.10.2 The t-test", 170),
    ("10.11 Exercises", 170),
    ("11 Bayesian Inference", 175),
    ("11.1 The Bayesian Philosophy", 175),
    ("11.2 The Bayesian Method", 176),
    ("11.3 Functions of Parameters", 180),
    ("11.4 Simulation", 180),
    ("11.5 Large Sample Properties of Bayes’ Procedures", 181),
    ("11.6 Flat Priors, Improper Priors, and “Noninformative” Priors", 181),
    ("11.7 Multiparameter Problems", 183),
    ("11.8 Bayesian Testing", 184),
    ("11.9 Strengths and Weaknesses of Bayesian Inference", 185),
    ("11.10 Bibliographic Remarks", 189),
    ("11.11 Appendix", 190),
    ("11.12 Exercises", 190),
    ("12 Statistical Decision Theory", 193),
    ("12.1 Preliminaries", 193),
    ("12.2 Comparing Risk Functions", 194),
    ("12.3 Bayes Estimators", 197),
    ("12.4 Minimax Rules", 198),
    ("12.5 Maximum Likelihood, Minimax, and Bayes", 201),
    ("12.6 Admissibility", 202),
    ("12.7 Stein’s Paradox", 204),
    ("12.8 Bibliographic Remarks", 204),
    ("12.9 Exercises", 204),
    ("III. Statistical Models and Methods", 208),
    ("13 Linear and Logistic Regression", 209),
    ("13.1 Simple Linear Regression", 209),
    ("13.2 Least Squares and Maximum Likelihood", 212),
    ("13.3 Properties of the Least Squares Estimators", 214),
    ("13.4 Prediction", 215),
    ("13.5 Multiple Regression", 216),
    ("13.6 Model Selection", 218),
    ("13.7 Logistic Regression", 223),
    ("13.8 Bibliographic Remarks", 225),
    ("13.9 Appendix", 225),
    ("13.10 Exercises", 226),
    ("14 Multivariate Models", 231),
    ("14.1 Random Vectors", 232),
    ("14.2 Estimating the Correlation", 233),
    ("14.3 Multivariate Normal", 234),
    ("14.4 Multinomial", 235),
    ("14.5 Bibliographic Remarks", 237),
    ("14.6 Appendix", 237),
    ("14.7 Exercises", 238),
    ("15 Inference About Independence", 239),
    ("15.1 Two Binary Variables", 239),
    ("15.2 Two Discrete Variables", 243),
    ("15.3 Two Continuous Variables", 244),
    ("15.4 One Continuous Variable and One Discrete", 244),
    ("15.5 Appendix", 245),
    ("15.6 Exercises", 248),
    ("16 Causal Inference", 251),
    ("16.1 The Counterfactual Model", 251),
    ("16.2 A Randomized Experiment", 253),
    ("16.3 Observational Studies", 254),
    ("16.4 The Propensity Score", 255),
    ("16.5 Sensitivity Analysis", 257),
    ("16.6 Remarks", 258),
    ("16.7 Appendix", 258),
    ("16.8 Exercises", 258),
    ("17 Statistical Learning", 261),
    ("17.1 A Clustering Problem", 261),
    ("17.2 Supervised Learning", 261),
    ("17.3 Unsupervised Learning", 264),
    ("17.4 Bibliographic Remarks", 265),
    ("17.5 Exercises", 266),
    ("18 Nonparametric Smoothing", 267),
    ("18.1 The Problem", 267),
    ("18.2 Kernel Estimation", 269),
    ("18.3 Density Estimation", 269),
    ("18.4 Bibliographic Remarks", 273),
    ("18.5 Appendix", 273),
    ("18.6 Exercises", 273),
    ("19 Wavelets", 277),
    ("19.1 Introduction", 277),
    ("19.2 The Wavelet Transform", 278),
    ("19.3 Some Wavelet Families", 279),
    ("19.4 An Example: VisuShrink", 279),
    ("19.5 Bibliographic Remarks", 281),
    ("19.6 Exercises", 281),
    ("20 Curve Estimation", 283),
    ("20.1 Introduction", 283),
    ("20.2 Kernel Estimation", 283),
    ("20.3 Local Polynomial Models", 285),
    ("20.4 Bibliographic Remarks", 288),
    ("20.5 Exercises", 288),
    ("IV.  From Sample to Population", 292),
    ("21 Random Samples", 293),
    ("21.1 Random Samples and Statistics", 293),
    ("21.2 Statistics and Their Distributions", 294),
    ("21.3 The Sample Mean and Variance", 294),
    ("21.4 The Sample Median", 295),
    ("21.5 Order Statistics", 297),
    ("21.6 Quantiles", 297),
    ("21.7 Empirical Distribution Functions", 298),
    ("21.8 The Hypergeometric Distribution", 300),
    ("21.9 Bibliographic Remarks", 300),
    ("21.10 Exercises", 301),
    ("22 Normal Samples", 305),
    ("22.1 The Joint Distribution of the Sample Mean and Variance", 305),
    ("22.2 Distribution of the Sample Mean", 305),
    ("22.3 Distribution of the Sample Variance", 307),
    ("22.4 Student’s t", 308),
    ("22.5 Distribution of the Sample Correlation", 310),
    ("22.6 Distribution of the Sample Regression Coefficients", 311),
    ("22.7 The Bivariate Normal Distribution", 313),
    ("22.8 Distributions of Quadratic Forms", 314),
    ("22.9 The Multivariate Normal Distribution", 317),
    ("22.10 The Wishart Distribution", 318),
    ("22.11 The Multivariate t Distribution", 320),
    ("22.12 Bibliographic Remarks", 322),
    ("22.13 Exercises", 322),
    ("23 The Bootstrap and Resampling Methods", 325),
    ("23.1 The Plug-in Principle", 325),
    ("23.2 The Bootstrap", 326),
    ("23.3 Bootstrap Confidence Intervals", 328),
    ("23.4 Estimating the Distribution of a Sample Quantile", 329),
    ("23.5 Estimating the Distribution of the Sample Mean", 330),
    ("23.6 Bibliographic Remarks", 330),
    ("23.7 Appendix", 331),
    ("23.8 Exercises", 331),
    ("V. Asymptotics", 336),
    ("24 Modes of Convergence", 337),
    ("24.1 Basic Concepts", 337),
    ("24.2 Weak Convergence", 339),
    ("24.3 The Multivariate Central Limit Theorem", 341),
    ("24.4 Bibliographic Remarks", 342),
    ("24.5 Exercises", 343),
    ("25 Asymptotic Methods", 345),
    ("25.1 A Stochastic Approximation", 345),
    ("25.2 Estimating the Coverage Error of the Bootstrap Percentile Method", 347),
    ("25.3 The Delta Method", 348),
    ("25.4 Slutsky’s Theorem", 350),
    ("25.5 Distribution-Free Methods", 351),
    ("25.6 Empirical Processes", 352),
    ("25.7 Bibliographic Remarks", 353),
    ("25.8 Exercises", 353),
    ("VI. Additional Topics", 356),
    ("26 Nonparametric Statistics", 357),
    ("26.1 Hypothesis Testing", 357),
    ("26.2 Confidence Intervals", 360),
    ("26.3 Bibliographic Remarks", 361),
    ("26.4 Appendix", 361),
    ("26.5 Exercises", 362),
    ("27 Multiple Testing", 365),
    ("27.1 Introduction", 365),
    ("27.2 False Discovery Rate", 365),
    ("27.3 Bibliographic Remarks", 367),
    ("27.4 Exercises", 368),
    ("VII. Measure Theory", 370),
    ("28 Measures, Integrals and Lp Spaces", 371),
    ("28.1 Measures", 371),
    ("28.2 Measurable Functions", 372),
    ("28.3 Integration", 374),
    ("28.4 Lp Spaces", 376),
    ("28.5 Product Spaces", 377),
    ("28.6 Bibliographic Remarks", 378),
    ("28.7 Appendix", 378),
    ("28.8 Exercises", 378),
    ("VIII Appendix", 382),
    ("A Some Mathematical Tools", 383),
    ("A.1 Vectors and Matrices", 383),
    ("A.2 Complex Numbers", 386),
    ("A.3 Analysis", 386),
    ("A.4 Bibliographic Remarks", 387),
    ("A.5 Exercises", 387),
    ("B Some Theoretical Results", 391),
    ("B.1 Gamma Function", 391),
    ("B.2 Stirling’s Formula", 392),
    ("B.3 Bessel Functions", 392),
    ("B.4 Taylor Series Expansion", 393),
    ("B.5 Integration By Parts", 393),
    ("B.6 Jensen’s Inequality", 393),
    ("B.7 Cauchy-Schwarz Inequality", 394),
    ("B.8 Bibliographic Remarks", 394),
    ("B.9 Exercises", 394),
    ("C Solutions to Selected Exercises", 397),
    ("D Tables", 413),
    ("E References", 429),
    ("F Index", 447)
]




# Paths to the input and output PDF files
input_pdf_path = "yourfile.pdf"
output_pdf_path = "output_with_toc.pdf"

# Offset to adjust for the page number shift
offset = 16  # Since the first TOC page is 23 in the actual PDF, the offset is 23 - 1

# Read the input PDF
reader = PdfReader(input_pdf_path)
writer = PdfWriter()

# Copy all pages from the reader to the writer
for page in reader.pages:
    writer.add_page(page)

# Add bookmarks using add_outline_item with the offset
for title, page_num in toc_entries:
    writer.add_outline_item(title, page_num - 1 + offset)

# Write to the output PDF
with open(output_pdf_path, "wb") as f:
    writer.write(f)

print(f"Bookmarks added successfully. Output saved as {output_pdf_path}")
